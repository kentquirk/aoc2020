This code uses a parser generator:

```bash
go get -u github.com/pointlander/peg
```

The command line to generate it was:

```bash
peg -switch -inline grammar.peg
```
